# 趣谈网络协议

## 开篇词

### 开篇词 | 想成为技术牛人？先搞定网络协议！

> 第一，我会从身边经常见到的事情出发，用故事来讲解各种网络协议，然后慢慢扩展到不熟悉的领域。
> 
> 第二，我会用贴近场景的方式来讲解网络协议，将各个层次的关系串起来，而非孤立地讲解某个概念。
> 
> 第三，我会在讲解完各个层次的网络协议之后，着重剖析如何在当下热门领域使用这些协议，比如云计算、容器和微服务。

## 第一模块 通信协议综述 (4讲)

#### 第1讲 | 为什么要学习网络协议？

> 只有通过这种协议，计算机才知道我们想让它做什么。

协议三要素

- 语法，就是这一段内容要符合一定的规则和格式。例如，括号要成对，结束要使用分号等。

- 语义，就是这一段内容要代表某种意义。例如数字减去数字是有意义的，数字减去文本一般来说就没有意义。

- 顺序，就是先干啥，后干啥。例如，可以先加上某个数值，然后再减去某个数值。

TCP 协议里面会有两个端口，一个是浏览器监听的端口，一个是电商的服务器监听的端口。

![](https://static001.geekbang.org/resource/image/64/0c/64fcf0cc5baade70769da2160637d70c.jpg?wh=1435*877)

![](https://static001.geekbang.org/resource/image/59/54/5985d6d430e1b1d3f165bf0f916ed954.jpg?wh=1603*1198)

#### 第2讲 | 网络分层的真实含义是什么？

**网络为什么要分层？**

> 分层是一个逻辑概念，在做架构设计时，有句话叫没有什么问题是多加一层解决不了的。计算机网络的分层也是程序逻辑上的抽象。

![](https://static001.geekbang.org/resource/image/5c/76/5c00f6e610f533d17fb4ad7decacc776.jpg?wh=3226*3472)

### 第3讲 | ifconfig：最熟悉又陌生的命令行

> C类地址包含的最大主机数太少了。只有254个主机。 为什么是254个而不是255个？ 因为192.168.x.255不能作为主机，因为这是一个广播地址，只要给192.168.x.255地址发送网络包，处于192.168.x网段的所有机器都能够收到此网络包。

**无类型域间选路（CIDR）**

> CIDR 10.100.122.2/24 前24位是网络号，后8（32-24）位是主机号。 同一个网络号内，可以通过mac地址访问。 子网掩码是：将网络号位都置为1，主机号位用0补齐，即 255.255.255.0 广播地址是：网络号位不变，主机号用1补齐，即 10.100.122.255

网络号

> 将子网掩码和 IP 地址进行 AND 计算。前面三个 255，转成二进制都是 1。1 和任何数值取 AND，都是原来数值，因而前三个数不变，为 10.100.122。后面一个 0，转换成二进制是 0，0 和任何数值取 AND，都是 0，因而最后一个数变为 0，合起来就是 10.100.122.0。这就是网络号。
